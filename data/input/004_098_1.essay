
ARG COMPOSER_VERSION=2.7
ENV APP_DIR=/composer
FROM composer:${COMPOSER_VERSION} AS builder

WORKDIR $APP_DIR

COPY ./site/composer.json $APP_DIR/

RUN composer install

ARG PHP_VERSION=8.1
FROM php:${PHP_VERSION}-fpm
ENV APP_DIR=/composer

COPY --from=builder ${APP_DIR}/vendor /var/www/html/vendor

COPY ./site/ /var/www/html/
